# Reference this view as omni_dbt_hr_bi__dim_employee
schema_label: ""

schema: omni_dbt_hr_bi
table_name: DIM_EMPLOYEE

dimensions:
  employee_id:
    sql: '"EMPLOYEE_ID"'
    format: ID
    primary_key: true

  employeenumber:
    sql: '"EMPLOYEENUMBER"'

  firstname:
    sql: '"FIRSTNAME"'

  lastname:
    sql: '"LASTNAME"'
    #This description was pulled from dbt.
    description: employee last name

  education:
    sql: '"EDUCATION"'

  educationfield:
    sql: '"EDUCATIONFIELD"'

  age:
    sql: '"AGE"'

  gender:
    sql: '"GENDER"'

  maritalstatus:
    sql: '"MARITALSTATUS"'

  joblevel:
    sql: '"JOBLEVEL"'

  yearsincurrentrole:
    sql: '"YEARSINCURRENTROLE"'

  yearssincelastpromotion:
    sql: '"YEARSSINCELASTPROMOTION"'

  yearswithcurrmanager:
    sql: '"YEARSWITHCURRMANAGER"'

  department:
    sql: '"DEPARTMENT"'

  manager:
    sql: '"MANAGER"'

  jobrole:
    sql: '"JOBROLE"'

  country:
    sql: '"COUNTRY"'

  cc_start_date:
    sql: '"CC_START_DATE"'

  cc_end_date:
    sql: '"CC_END_DATE"'

  monthlyincome:
    sql: '"MONTHLYINCOME"'

  bonus_percent:
    sql: '"BONUS_PERCENT"'

  yearlycomission:
    sql: '"YEARLYCOMISSION"'

  valid_from:
    sql: '"VALID_FROM"'

  valid_to:
    sql: '"VALID_TO"'

  country_department_:
    sql: CONCAT(COALESCE(CONCAT(COALESCE(${omni_dbt_hr_bi__dim_employee.country},
      ''), ' - '), ''), COALESCE(${omni_dbt_hr_bi__dim_employee.department},
      ''))
    label: "Country Department "

  manager_jobrole:
    sql: b."JOBROLE"

  age_bin:
    sql: ${omni_dbt_hr_bi__dim_employee.age}
    bin_boundaries: [ 18, 20, 30, 40, 50, 60 ]
    label: Age Bins

measures:
  count:
    aggregate_type: count

  age_average:
    sql: ${omni_dbt_hr_bi__dim_employee.age}
    aggregate_type: average

  age_sum:
    sql: ${omni_dbt_hr_bi__dim_employee.age}
    aggregate_type: sum

  monthlyincome_sum:
    sql: ${omni_dbt_hr_bi__dim_employee.monthlyincome}
    aggregate_type: sum

  custom_measure_0:
    sql: COUNT(DISTINCT ${omni_dbt_hr_bi__dim_employee.employee_id}) OVER (PARTITION
      BY ${omni_dbt_hr_bi__dim_employee.manager})
    aggregate_type: average

  employee_id_count_distinct:
    sql: ${omni_dbt_hr_bi__dim_employee.employee_id}
    format: ID
    aggregate_type: count_distinct

  manager_count_distinct:
    sql: ${omni_dbt_hr_bi__dim_employee.manager}
    aggregate_type: count_distinct

#The info below was pulled from your dbt repository and is read-only.
dbt:
  name: dim_employee
  target_schema: ANALYTICS
  config:
    schema: HR_BI
    materialized: table
  code: |-
    select employee_id
        ,employeenumber
        ,firstname
        ,lastname
        ,education
        ,educationfield
        ,age
        ,gender
        ,maritalstatus
        ,joblevel
        ,yearsincurrentrole
        ,yearssincelastpromotion
        ,yearswithcurrmanager
        ,department
        ,manager
        ,jobrole
        ,country
        ,cc_start_date
        ,cc_end_date
        ,monthlyincome
        ,bonus_percent
        ,comission as yearlycomission
        ,dim_start_date as valid_from
        ,dim_end_date as valid_to
    from {{ref('one_big_table')}}
    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24
    order by employee_id
